
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <title>ABAHQU Lev.1p</title>
  <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;  
        /*border: 1px solid rgb(8, 1, 1);*/
      }

     h1 {
      color: #3498db;
      margin-bottom: 20px;
      margin-bottom: 0; 
      padding-bottom: 0;
      font-style:bold;
     }
     .inputSelect {
      margin-top:10px;
      padding: 8px;
      width:100%;
      border-radius: 5px;
      border: 1px solid #ccc; 
      font-size: 18px;      
      text-align:center;
     } 

      .inputSelectMulaiSampai {
      margin-top:10px;
      padding: 8px;
      width:100%;
      border-radius: 5px;
      border: 1px solid #ccc; 
      font-size: 18px;      
      text-align:center;
     } 
    
     #fileInput {     
      padding: 8px;
      width: 100%;
      border-radius: 5px;
      border: 1px solid #ccc; 
      font-size:18px;
     } 
     .flexDivInput{      
      display: flex;
      flex-wrap:wrap;        
      margin-top: 10px; 
      margin-bottom:10px;         
      font-size: 18px;   
      
     }
     .flexDiv{      
      display: flex;
      flex:2;
      gap: 10px;
      margin-top: 10px; 
      margin-bottom:10px;         
      font-size: 18px; 
            
    }  
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;      
      height: 100vh;

    }
    #audioPlayer {
      margin-top: 10px;
      margin-bottom: 10px;
      width: 100%;
      
    }
    .container {
       
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      text-align:center;
      max-width: 600px;  
      margin:10px;        
    }
    
    .button:hover {
      background-color: #2980b9;
    }

    #divStopPrevNext{      
      display: flex;      
      gap: 10px;
      margin-top: 10px; 
      margin-bottom: 10px;        
    }

    .stopPrevNext {
      width: 100%;
      font-size: 18px; 
      background-color: #3498db;
      color: white;
      padding: 10px 0px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 5px;   
    }

    .tombolService {
      margin-top: 20px; 
      border: 1px solid #3498db; 
      font-size: 15px;  
      background-color: white; 
      color: black;
      padding: 5px;      
    }

    .apm_max {
      display: none;
      border: none; 
      background-color: white; 
      padding: 0; 
      color: rgb(39, 37, 37);
    }

    .apm_baru{
      width: 30px; 
      display: none; 
      text-align: right;
    }

    .apm {
      border: 1px solid darkgray; 
      padding: 2px; 
      margin-left: 2px;
    }    

</style>
</head>
<body>
  <div class="container">
    <h1 >ABAHQU <span style="font-size: 20px;">Lev.1p</span></h1>
    <p style="margin-bottom: 30px; padding-top: 0;">Alat Bantu Hafalan & Muraja'ah AlQuran</p>
    <input type="file" id="fileInput" webkitdirectory directory multiple >    

    <div style="width: 100%; display: flex; gap: 10px; margin-top: 20px; justify-content: center;" >
      <div >
        
        <div style="display: flex; gap:5px; margin-top: 5px;" >
          <div>
            <div><label>Mulai Surat/ Ayat</label></div>
            <div><select class="inputSelectMulaiSampai" id="mulaiSurat">
              <option value="" selected="true">pilih</option>   
            </select></div>
            <div><select class="inputSelectMulaiSampai" id="mulaiAyat">
              <option value="" selected="true">pilih</option> 
            </select></div> 
          </div>          
        </div>
      </div>
      <div >
       
        <div style="display: flex; gap:5px; margin-top: 5px;">
          <div>
            <div style="width: max-content;"><label>Sampai Surat/ Ayat</label></div>
            <div><select class="inputSelectMulaiSampai" id="sampaiSurat">
              <option value="" selected="true">pilih</option> 
            </select></div>
            <div><select class="inputSelectMulaiSampai" id="sampaiAyat">
              <option value="" selected="true">pilih</option> 
            </select></div>
          </div>
          
        </div>
      </div>    
    </div>


    <div class="flexDiv" >
      <div class="flexDivInput">
        <label style="width: 100%;" for="mode">Mode: </label>
        <select class="inputSelect" id="mode">  
            <option value="" selected="true">-- Pilih Mode --</option>          
            <option value="db">dengar & baca</option>
            <option value="bd">baca & dengar</option>
            <option value="ds">dengar saja</option>
            <option value="d1">dengar ayat ganjil</option>
            <option value="d2">dengar ayat genap</option>            
            
        </select>
      </div>
      <div class="flexDivInput">
        <label style="width: 100%;" for="putaran">Putaran: </label>        
        <select class="inputSelect" id="putaran">
            <option value=1>1</option>
            <!-- Pilihan putaran akan ditambahkan secara dinamis -->
        </select> 
      </div>     
    </div>
    <div id="divGanjilGenap" style="display: none;">
      <label for="modeGanjilGenap">mode ganjil-genap:</label>
      <input type="checkbox" id="modeGanjilGenap">
    </div>
    <audio id="audioPlayer" controls ></audio><br>
    <div id="ketPlayer" class="flexDivInput">
      <div id="indikatorAudio">Belum ada file</div> 
      <div>
        <label class="apm" id="audioKe" >a 0/0</label>      
        <label class="apm" id="putaranKe" >p 0/0</label> 
        <label class="apm" id="frekMode" >m 0/0</label>      
      </div>
    </div>

    <div class="flexDiv">
      <label id="petunjukUbah" style="display: none;">a, p, m :</label>
      <input class="apm_baru" id="a_Baru" type="number">
      <button class="apm_max" id="a_max"  ></button>
      <input class="apm_baru" id="p_Baru" type="number">
      <button class="apm_max" id="p_max" ></button>
      <input class="apm_baru" id="m_Baru" type="number">
      <button class="apm_max" id="m_max" ></button>
      <button id="simpanCounterBaru" style="display: none;">OK</button>
    </div>
    <div id="divStopPrevNext">
      <button class="stopPrevNext" id="stopButton" >Stop</button>
      <button class="stopPrevNext" id="prevButton" >prev</button>
      <button class="stopPrevNext" id="nextButton" >next</button>
    </div>    
    
    <button class="tombolService" id="tombolFitur"  style="display:none;" >Fitur</button>
    <button class="tombolService" id="tombolRuteku" style="display:none;" >ruteku</button>
    <button class="tombolService" id="tombolCatatan" >Refleksi</button>
    <button class="tombolService" id="tombolCaranya" >Caranya?</button>
    
    <div >    
      <div id="isiFitur" style="display:none;">    
        <ul style="text-align: left;margin: 10px; ">      
          <li>[.........Lev.1_] sudah bisa menjalankan 1 file</li>
          <li>[.........Lev.1_] URL dibuat dengan mengklik tombol input (browse)</li>
          <li>[.........Lev.1_] file audio dijalankan setelah mengklik tombol "play" pada player</li>
          <li>[.........Lev.1_] setelah file selesai, bisa dijalankan lagi dg menekan tombol play  </li>
          <li>[.........Lev.1a] menampilkan indikator file audio siap dijalankan, setelah tombol browse/input diproses</li>
          <li>[.........Lev.1a] sudah bisa mengupload banyak file </li>
          <li>[.........Lev.1b] menampilkan nama file jika tombol play di klik, sebagai indikator bahwa file tersebut sedang diputar</li>    
          <li>[.........Lev.1c] sudah bisa menjalankan banyak file </li>
          <li>[.........Lev.1c] setelah audio 1 selesai, langsung memutar audio 2, begitu seterusnya </li>
          <li>[.........Lev.1d] setelah semua file selesai diputar, player langsung kembali memutar file audio pertama </li>
          <li>[.........Lev.1e] Tombol stop, prev dan next sudah tersedia dan bisa digunakan </li>
          <li>[.........Lev.1f] tersedia pilihan mode dan pilihan jumlah putaran, namun belum berfungsi </li>
          <li>[.........Lev.1g] tersedia fungsi pengkondisian 'jumlah pengulangan' berdasarkan pilihan 'mode' </li>
          <li>[.........Lev.1g] tersedia fungsi konversi 'jumlah pengulangan' ke 'sekali/berulangkali' saat merubah nilai 'mode' dan 'ulang' </li>
          <li>[.........Lev.1h] input mode dan Ulang dipindahkan keatas input file, dibawah baris judul' </li>
          <li>[.........Lev.1h] mode ds (sekali atau berulang) sudah bisa berfungsi </li>
          <li>[.........Lev.1i] ada penambahan indikator file ke / jumlah file, symbol a 0/0 = audio </li>
          <li>[.........Lev.1i] ada penambahan indikator pengulangan ke / jumlah pengulangan berdasarkan pilihan Mode, symbol m 0/0 = mode </li>
          <li>[.........Lev.1i] ada penambahan indikator putaran ke / jumlah putaran, symbol p 0/0 = putaran </li>
          <li>[.........Lev.1i] ada sedikit penyesuaian layout  </li>
          <li>[.........Lev.1j] mode d1 (dengar audi ganjil), dan mode d2 (dengar audio genap) sudah bisa berjalan  </li>
          <li>[.........Lev.1k] mode db (dengar dan baca) serta mode bd (baca dan dengar) untuk satu putaran sudah bisa berjalan </li>
          <li>[.........Lev.1k] ada tambahan fitur 'ruteku', berguna untuk mentracking pembacaan coding oleh website  </li>
          <li>[.........Lev.1k] penambahan function 'pengaturanVolume', untuk penyederhanaan script</li>
          <li>[.........Lev.1l] penambahan function aktif/nonaktifkan fungsi 'ruteku', beserta warna indikatornya </li>
          <li>[.........Lev.1l] penambahan function 'juruHitung' sebagai counter file, putaran, angka-mode  </li>
          <li>[.........Lev.1l] kendala: pada kasus audio di stop, kemudian ganti mode, maka angka 'juruHitung' jadi berlebih  </li>        
          <li>[.........Lev.1m] perbaikan fungsi dan penempatan function ' juruHitung'  </li>   
          <li>[.........Lev.1m] perbaikan penempatan function 'pengaturanVolume'</li>  
          <li>[.........Lev.1m] fitur db (dengar dan baca) untuk banyak putaran sudah bisa berjalan</li>   
          <li>[.........Lev.1n] fitur bd (baca dan dengar) untuk banyak putaran sudah bisa berjalan</li>   
          <li>[.........Lev.1n] penambahan fitur ubah nilai counter</li> 
          <li>[.........Lev.1o] sudah menggunakan pewarnaan</li> 
          <li>[.........Lev.1o] tombol updatePerulangan di hilangkan, fungsinya dipindahkan ke tombol perulangan</li>
          <li>[.........Lev.1o] konversi inline CSS ke internal CSS</li>
          <li>[baru..Lev.1p] penambahan fitur 'genap-ganjil' jika diaktifkan maka mode genap dan ganjil akan dijalanakan bergantian</li>
          <li>[baru..Lev.1p] penambahan fitur catatan, tempat menuliskan ide</li>
          <li>[baru..Lev.1p] ganti fitur catatan menjadi refleksi, isi dukungan pengawas dan kepsek beserta link</li>
        </ul>
      </div>    
      <div id="rute" style="text-align: left;margin: 10px;"></div> 
      <div id="isiCatatan" style="display:none; border: 1px solid darkgray; padding: 2px; max-width: 358px;" >
        
          <div style="text-align: left;margin: 10px;"> Dukungan Pengawas SMP Dinas Pendidikan dan Kebudayaan Kota Padang <a href="https://web.facebook.com/share/v/19hQEhB7P9/" target='_blank'>disini</a></div>
          <div style="text-align: left;margin: 10px;"> Dukungan Kepala SMP Perguruan Islam Ar Risalah <a href="https://www.instagram.com/reel/DPzrYAsk32A/?igsh=MWFpdnF5aXBsdDNqeQ==" target='_blank'>disini</a></div>
          <div style="text-align: left;margin: 10px;"> Video Membangun Abahqu metode STAR <a href="https://youtu.be/i5LwM_63_AA?si=mLa2YLaNi-8IZNOB" target='_blank'>disini</a></div>
          
      </div>  
      <div id="isiCaranya" style="display:none; border: 1px solid darkgray; padding: 2px; max-width: 358px;" >            
            <div style="text-align: left;margin: 10px;  background-color: #c3cbdd; ">Ini adalah aplikasi online. Untuk kemudahan akses, silahkan klik titik tiga di kanan atas android, lalau klik "buat pintasan kelayar utama"/ "tambahkan ke layar utama". Jika butuh versi offline, silahkan unduh di <a href="https://drive.google.com/drive/folders/1F1bmBAnfdk_dsPeF2UcNdNPr4Ov9a7iv?usp=drive_link" target='_blank'>drive</a>. jika belum ada. <i>Catatan: pada beberapa android, untuk aplikasi web offline, taidak tersedia fitur "buat pintasan ke layar Utama"</i></div>
            <div style="text-align: left;margin: 10px; ">jika di hp atau laptop belum ada mp3 quran per-ayat, maka silahkan unduh di <a href="https://drive.google.com/drive/folders/1F1bmBAnfdk_dsPeF2UcNdNPr4Ov9a7iv?usp=drive_link" target='_blank'>drive</a> Silahkan pilih ayat2 yang dibutuhkan saja. Penamaan file 0101A-001001 berarti juz ke 01 lembar ke 01 surat 001 ayat ke 001. Jika ingin memilih qori lain silahkan kunjungi website: <a href="https://everyayah.com/" target='_blank'>disini</a>. Jika unduhan berupa file zip atau rar, silahkan di ekstrak terlebih dahulu, dan sebaiknya di simpan dalam satu folder</div>
            <div style="text-align: left;margin: 10px;  background-color: #c3cbdd;  ">[untuk penggunaan offline] cari aplikasi yang sudah diunduh, lalu klik 2x</div>
            <div style="text-align: left;margin: 10px; ">[untuk penggunaan offline]jika aplikasi sudah terbuka, silahkan buat shortcut ke halaman depan, untuk memudahkan penggunaan saja, jika memungkinkan. Sebagian android tidak mengizinkannya.</div>
            <div style="text-align: left;margin: 10px;  background-color: #c3cbdd; ">Klik tombol Browse untuk memilih file yang akan dijalankan</div>
            <div style="text-align: left;margin: 10px; ">Klik tombol Mode untuk memilih Mode</div>
            <div style="text-align: left;margin: 10px;  background-color: #c3cbdd; ">klik tombol putaran untuk memilih pengulangan</div>
            <div style="text-align: left;margin: 10px; ">klik ikon play untuk menjalankan</div>
            <div style="text-align: left;margin: 10px;  background-color: #c3cbdd; ">jangan lupa isi buku kunjungan</div>        
      </div>   
    </div> 
    <div style="text-align: center; margin: 10px;"> isi buku kunjungan <a href="https://forms.gle/jZuu1zWXDf5Sw3km9" target='_blank'>disini</a></div>
    <div style="text-align: center; margin: 10px;"> <a href="index.html" target='_blank'>Home</a></div>
</div> 
 
  
  <script>
                                                                    
    const fileInput = document.getElementById('fileInput');    //deklarasi fileInput, audioPlayer, dan indikatorAudio diambil dari id yg sesuai
    const mulaiSurat = document.getElementById('mulaiSurat'); 
    const mulaiAyat = document.getElementById('mulaiAyat'); 
    const sampaiSurat = document.getElementById('sampaiSurat'); 
    const sampaiAyat = document.getElementById('sampaiAyat'); 
    const audioPlayer = document.getElementById('audioPlayer');
    const indikatorAudio = document.getElementById('indikatorAudio');
    const audioKe = document.getElementById('audioKe');
    const frekMode = document.getElementById('frekMode');
    const putaranKe = document.getElementById('putaranKe');
    const catatan = document.getElementById('catatan');
    const stopButton = document.getElementById('stopButton');
    const prevButton = document.getElementById('prevButton');
    const nextButton = document.getElementById('nextButton');
    const mode = document.getElementById('mode');    
    const putaran = document.getElementById('putaran');
    const tombolFitur = document.getElementById('tombolFitur');
    const isiFitur = document.getElementById('isiFitur');
    const rute = document.getElementById('rute');    
    const simpanCounterBaru = document.getElementById('simpanCounterBaru');
    const petunjukUbah = document.getElementById('petunjukUbah');
    const a_Baru = document.getElementById('a_Baru');
    const p_Baru = document.getElementById('p_Baru');
    const m_Baru = document.getElementById('m_Baru');
    const a_max = document.getElementById('a_max');  
    const p_max = document.getElementById('p_max');  
    const m_max = document.getElementById('m_max');
    const modeGanjilGenap = document.getElementById('modeGanjilGenap');
    const divGanjilGenap = document.getElementById('divGanjilGenap');
    const tombolCatatan = document.getElementById('tombolCatatan');
    const isiCatatan = document.getElementById('isiCatatan');  
    const tombolCaranya = document.getElementById('tombolCaranya');  
    const isiCaranya = document.getElementById('isiCaranya');    

    let tipe;    
    let frekuensi;     
    let varrayFile = [];
    let nomor ;    
    let dahPutar = 1; 
    let sembunyikan = "ya";
    let angkaFrekMode = 0;
    let frekModeKe = 1;
    let semuaRuteku = "";
    let a;
    let aktifkanRute = false;
    let suratAwal;
    let suratAkhir;
    let ayatAwal;
    let ayatAkhir;
    let ItemAmulaiAyat;
    let ItemZmulaiAyat;
    let jumlahItem;
    let nilaiMulaiSurat; 
    let nilaiMulaiAyat;
    let nilaiSampaiSurat;
    let nilaiSampaiAyat;
    let ItemSampaiAyat;
    let ItemZsampaiAyat;  
    let BanyakBaris;
    let sampai_BarisKe;

    switch (mode.value){                                        // konversi: mode ke tipe
      case "bd": tipe = "2x"; angkaFrekMode = 2; break;
      case "db": tipe = "2x"; angkaFrekMode = 2; break;
      case "ds": tipe = "1x"; angkaFrekMode = 1; break;
      case "d1": tipe = "1x"; angkaFrekMode = 1; break;
      case "d2": tipe = "1x"; angkaFrekMode = 1; break;      
    }

    tampilkanDivGanjilGenap()    
    frekMode.textContent = `m 0/${angkaFrekMode}`;
    putaranKe.textContent = `p 0/${putaran.value}`;    
    putaran2frekuensi();     

    pengaturanVolume();

    fileInput.addEventListener('change', function () {           //perubahan pada file input menjalankan script dalam {}                                                               
      //>>> Menyimpan input dalam array dan mengurutkan nama file
      const arrayFile = Array.from(fileInput.files);             //variabel arrayFile menyimpan nilai array file dari fileInput
      arrayFile.sort((a,b)=>a.name.localeCompare(b.name)); 
      varrayFile = arrayFile;                                    //menyimpan nilai konstanta ke variabel supaya bisa dipakai di luar function     
      //>>> mengambil nomor surat pertama dan nomor surat terakhir pada array
      suratAwal = Number(arrayFile[0].name.slice(0,3));
      suratAkhir = Number(arrayFile[arrayFile.length-1].name.slice(0,3));
      ayatAwal = Number(arrayFile[0].name.slice(3,6));
      ayatAkhir = Number(arrayFile[arrayFile.length-1].name.slice(3,6));      
      
      //alert(suratAwal);
      //alert(suratAkhir);
      //alert(ayatAwal);
      //alert(ayatAkhir);
      
      //>>> menampilkan pilihan awal = "pilih"
      const defaultOption =document.createElement("option");
      mulaiSurat.textContent="";
      defaultOption.textContent = "pilih";
      defaultOption.value = "";
      defaultOption.disabled = true;
      defaultOption.selected = true;
      mulaiSurat.appendChild(defaultOption);

      //>>> menampilkan pilihan input nomor surat
      for (let i=1; i<= suratAkhir-suratAwal+1; i++){
        const option = document.createElement("option");
        option.value = suratAwal-1+i;
        option.textContent = noKeNamaSurat(suratAwal-1+i) ;
        mulaiSurat.appendChild(option);
      }

    /*  //>>> membuat objek URL
      varrayFile = arrayFile                                     //menyimpan nilai konstanta ke variabel supaya bisa dipakai di luar function    
      if (nomor < arrayFile.length ) {                           
        audioPlayer.src = URL.createObjectURL(arrayFile[0]);     //source dari audioPlayer = nilai fileURL = nilai URL file ke nol
        indikatorAudio.textContent = `siap memutar audio`;       //teks yg tampil pada div dg id 'filename' = nama file ke nol 
        audioKe.textContent = ` a ${nomor}/${varrayFile.length} `;       
      }
      pengaturanVolume();
      */
    }); 

    function suratKeJumlahAyat(nomorSurat){
        const jumlahAyat = { 1:7, 2:286, 3:200, 4:176, 5:120, 6:165, 7:206, 8:75, 9:129, 10:109, 
        11:123, 12:111, 13:43, 14:52, 15:99, 16:128, 17:111, 18:110, 19:98, 20:135, 21:112, 
        22:78, 23:118, 24:64, 25:77, 26:227, 27:93, 28:88, 29:69, 30:60, 31:34, 32:30, 33:73, 
        34:54, 35:45, 36:83, 37:182, 38:88, 39:75, 40:85, 41:54, 42:53, 43:89, 44:59, 45:37, 
        46:35, 47:38, 48:29, 49:18, 50:45, 51:60, 52:49, 53:62, 54:55, 55:78, 56:96, 57:29, 
        58:22, 59:24, 60:13, 61:14, 62:11, 63:11, 64:18, 65:12, 66:12, 67:30, 68:52, 69:52, 
        70:44, 71:28, 72:28, 73:20, 74:56, 75:40, 76:31, 77:50, 78:40, 79:46, 80:42, 81:29, 
        82:19, 83:36, 84:25, 85:22, 86:17, 87:19, 88:26, 89:30, 90:20, 91:15, 92:21, 93:11, 
        94:8, 95:8, 96:19, 97:5, 98:8, 99:8, 100:11, 101:11, 102:8, 103:3, 104:9, 105:5, 106:4, 
        107:7, 108:3, 109:6, 110:3, 111:5, 112:4, 113:5, 114:6 }; 
      return jumlahAyat[nomorSurat];
    }
    mulaiSurat.addEventListener('change', function () {       
      //>>> membuat pilihan/ option untuk "sampai surat"
      nilaiMulaiSurat = Number(mulaiSurat.value) ;

      sampaiSurat.textContent="";
      const defaultOption =document.createElement("option");
      defaultOption.textContent = "pilih";
      defaultOption.value = "";
      defaultOption.disabled = true;
      defaultOption.selected = true;
      sampaiSurat.appendChild(defaultOption);
      for (let i=1; i<= suratAkhir-nilaiMulaiSurat + 1; i++){
        const option = document.createElement("option");
        option.value = nilaiMulaiSurat-1+i;
        option.textContent = noKeNamaSurat(nilaiMulaiSurat-1+i);
        sampaiSurat.appendChild(option);
      }          

      // $:catatan jangan meletakkan "let" dalam block jika variabelnya digunakan juga diluar blok
      if (nilaiMulaiSurat == suratAwal){      
        ItemAmulaiAyat = ayatAwal;
        ItemZmulaiAyat = suratKeJumlahAyat(nilaiMulaiSurat);
        
      } else {
          ItemAmulaiAyat = 1;
          if (nilaiMulaiSurat == suratAkhir){  
            ItemZmulaiAyat = ayatAkhir;
          } else {
            ItemZmulaiAyat = suratKeJumlahAyat(nilaiMulaiSurat);
          }
      }
      
      jumlahItem = ItemZmulaiAyat-ItemAmulaiAyat;        

      const defaultOption2 =document.createElement("option");
        mulaiAyat.textContent="";
        defaultOption2.textContent = "pilih";
        defaultOption2.value = "";
        defaultOption2.disabled = true;
        defaultOption2.selected = true;
        mulaiAyat.appendChild(defaultOption2); 
        for (let i=1; i<= jumlahItem + 1; i++){
          const option = document.createElement("option");
          option.value = ItemAmulaiAyat + i -1;
          option.textContent =  ItemAmulaiAyat + i -1;
          mulaiAyat.appendChild(option);
        }         
        
    });

    sampaiSurat.addEventListener('change', function () {    
     
      nilaiMulaiSurat = Number(mulaiSurat.value);      
      nilaiMulaiAyat = Number(mulaiAyat.value);       
      nilaiSampaiSurat = Number(sampaiSurat.value);  
        
      if (nilaiSampaiSurat == nilaiMulaiSurat){      
        ItemAsampaiAyat = nilaiMulaiAyat;         
        ItemZsampaiAyat = suratKeJumlahAyat(nilaiSampaiSurat);        
      } else {
          ItemAsampaiAyat = 1;
          if (nilaiSampaiSurat == suratAkhir){ 
            ItemZsampaiAyat = ayatAkhir;
          } else {            
            ItemZsampaiAyat = suratKeJumlahAyat(nilaiSampaiSurat);
          }
      }
      
      jumlahItem = ItemZsampaiAyat-ItemAsampaiAyat; 
      const defaultOption2 =document.createElement("option");
        sampaiAyat.textContent="";
        defaultOption2.textContent = "pilih";
        defaultOption2.value = "";
        defaultOption2.disabled = true;
        defaultOption2.selected = true;
        sampaiAyat.appendChild(defaultOption2); 
        
        for (let i = 1; i <= jumlahItem + 1; i++){
          const option = document.createElement("option");
          option.value = ItemAsampaiAyat + i -1;
          option.textContent = ItemAsampaiAyat + i -1;
          sampaiAyat.appendChild(option);          
        }       
    });

    sampaiAyat.addEventListener('change', function () { 
      nilaiMulaiSurat = Number(mulaiSurat.value) ;
      nilaiMulaiAyat = Number(mulaiAyat.value)  ;
      nilaiSampaiSurat = Number(sampaiSurat.value) ;      
      nilaiSampaiAyat = Number(sampaiAyat.value) ;
       
      if (nilaiMulaiSurat !== "" && nilaiMulaiAyat !== "" && nilaiSampaiSurat !== "" && nilaiSampaiAyat !== ""){          

        ///////////////////
        let selisih_MulaiSurat = nilaiMulaiSurat-suratAwal;        
        let mulai_BarisKe = 0;         
        mulai_BarisKe = mulai_BarisKe + nilaiMulaiAyat - ayatAwal ;          
        if (selisih_MulaiSurat > 0){ 
          for (let i =0; i< selisih_MulaiSurat; i++){
            mulai_BarisKe = mulai_BarisKe + suratKeJumlahAyat(suratAwal + i);           
          } 
        }       
                  
        //alert(`nilaiMulaiSurat ${nilaiMulaiSurat} dan suratAwal ${suratAwal} dan selisih_MulaiSurat ${selisih_MulaiSurat} nilaiMulaiAyat ${nilaiMulaiAyat}`);
        
        /////////////////////
        let selisih_SampaiSurat = nilaiSampaiSurat-suratAwal;        
        sampai_BarisKe = 0;         
        sampai_BarisKe = sampai_BarisKe + nilaiSampaiAyat - ayatAwal ;         
        if (selisih_MulaiSurat > 0){ 
          for (let i =0; i< selisih_SampaiSurat; i++){
            sampai_BarisKe = sampai_BarisKe + suratKeJumlahAyat(suratAwal + i);            
          } 
        }         
        
        BanyakBaris = sampai_BarisKe - mulai_BarisKe;
      //>>> membuat objek URL

      
      nomor =  mulai_BarisKe;                                   
      
        audioPlayer.src = URL.createObjectURL(varrayFile[nomor]);     //source dari audioPlayer = nilai fileURL = nilai URL file ke nol
        indikatorAudio.textContent = `audio siap ..`;            //teks yg tampil pada div dg id 'filename' = nama file ke nol 
        audioKe.textContent = ` a ${nomor}/${sampai_BarisKe} `;        
      pengaturanVolume();
      }
    });

    mulaiAyat.addEventListener('change', function () { 
      
    });



    /*function tigaDigitkan(nilaiTarget){
      if (String(nilaiTarget).length ==3){
          nilaiTarget = nilaiTarget;
        } else {
          if (String(nilaiTarget).length ==2){
            nilaiTarget = "0" + nilaiTarget;
          } else {
              nilaiTarget = "00" + nilaiTarget;
          }
        }
      return nilaiTarget;
    }*/

    function noKeNamaSurat(nomorSurat){
        const namaSurat = { 1:"1. Al-Fatihah", 2:"2. Al-Baqarah", 3:"3. Ali 'Imran", 4:"4. An-Nisa'", 5:"5. Al-Ma'idah", 6:"6. Al-An'am", 
        7:"7. Al-A'raf", 8:"8. Al-Anfal", 9:"9. At-Taubah", 10:"10. Yunus", 11:"11. Hud", 12:"12. Yusuf", 13:"13. Ar-Ra'd", 
        14:"14. Ibrahim", 15:"15. Al-Hijr", 16:"16. An-Nahl", 17:"17. Al-Isra'", 18:"18. Al-Kahf", 19:"19. Maryam", 20:"20. Ta Ha", 
        21:"21. Al-Anbiya", 22:"22. Al-Hajj", 23:"23. Al-Mu'minun", 24:"24. An-Nur", 25:"25. Al-Furqan", 26:"26. Asy-Syu'ara'", 
        27:"27. An-Naml", 28:"28. Al-Qasas", 29:"29. Al-'Ankabut", 30:"30. Ar-Rum", 31:"31. Luqman", 32:"32. As-Sajdah", 33:"33. Al-Ahzab", 
        34:"34. Saba'", 35:"35. Fatir", 36:"36. Ya Sin", 37:"37. As-Saffat", 38:"38. Sad", 39:"39. Az-Zumar", 40:"40. Ghafir", 
        41:"41. Fussilat", 42:"42. Asy-Syura", 43:"43. Az-Zukhruf", 44:"44. Ad-Dukhan", 45:"45. Al-Jasiyah", 46:"46. Al-Ahqaf", 
        47:"47. Muhammad", 48:"48. Al-Fath", 49:"49. Al-Hujurat", 50:"50. Qaf", 51:"51. Az-Zariyat", 52:"52. At-Tur", 53:"53. An-Najm", 
        54:"54. Al-Qamar", 55:"55. Ar-Rahman", 56:"56. Al-Waqi'ah", 57:"57. Al-Hadid", 58:"58. Al-Mujadilah", 59:"59. Al-Hasyr", 
        60:"60. Al-Mumtahanah", 61:"61. As-Saff", 62:"62. Al-Jumu'ah", 63:"63. Al-Munafiqun", 64:"64. At-Tagabun", 65:"65. At-Talaq", 
        66:"66. At-Tahrim", 67:"67. Al-Mulk", 68:"68. Al-Qalam", 69:"69. Al-Haqqah", 70:"70. Al-Ma'arij", 71:"71. Nuh", 72:"72. Al-Jinn", 
        73:"73. Al-Muzzammil", 74:"74. Al-Muddassir", 75:"75. Al-Qiyamah", 76:"76. Al-Insan", 77:"77. Al-Mursalat", 78:"78. An-Naba'", 
        79:"79. An-Nazi'at", 80:"80. 'Abasa", 81:"81. At-Takwir", 82:"82. Al-Infitar", 83:"83. Al-Mutaffifin", 84:"84. Al-Insyiqaq", 
        85:"85. Al-Buruj", 86:"86. At-Tariq", 87:"87. Al-A'la", 88:"88. Al-Gasyiyah", 89:"89. Al-Fajr", 90:"90. Al-Balad", 91:"91. Asy-Syams", 
        92:"92. Al-Lail", 93:"93. Ad-Duha", 94:"94. Al-Insyirah", 95:"95. At-Tin", 96:"96. Al-'Alaq", 97:"97. Al-Qadr", 98:"98. Al-Bayyinah", 
        99:"99. Az-Zalzalah", 100:"100. Al-'Adiyat", 101:"101. Al-Qari'ah", 102:"102. At-Takasur", 103:"103. Al-'Asr", 104:"104. Al-Humazah", 
        105:"105. Al-Fil", 106:"106. Quraisy", 107:"107. Al-Ma'un", 108:"108. Al-Kausar", 109:"109. Al-Kafirun", 110:"110. An-Nasr", 
        111:"111. Al-Lahab", 112:"112. Al-Ikhlas", 113:"113. Al-Falaq", 114:"114. An-Nas" }; 
      return namaSurat[nomorSurat];
    }

    audioPlayer.addEventListener('play', function (){   //fRute(" Play()");     
      juruTulis(); 
    });

    function juruTulis(){                                           //fRute(" juruTulis()"); 
      indikatorAudio.textContent = varrayFile[nomor].name;          //fRute(" 9");                       //teks pada variabel indikatorAudio = nama audio yg sedang diputar
      audioKe.textContent = ` a ${nomor+1}/${sampai_BarisKe}/${varrayFile.length} `;  //fRute(" 10");      
      putaranKe.textContent = `p ${dahPutar}/${putaran.value}`;     //fRute(" 11");
      frekMode.textContent = ` m ${frekModeKe}/${angkaFrekMode} `;  //fRute(" 12");
    }

    audioPlayer.addEventListener('ended', function (){  //fRute(" Ended()");      //klik tombol play, maka akan menjalankan: 
                                                        
      juruHitung();                                      
      juruTulis();                                      
                                                        
      if (tipe == "1x"){
        if (frekuensi === "sekali"){          
          pengaturanVolume();         
          putarAudio();          

        }else if(frekuensi === "berulangkali"){ 
          if (dahPutar < Number(putaran.value)){ 
            audioPlayer.currentTime = 0;
            audioPlayer.play();            
          } else {            
            pengaturanVolume();
            putarAudio();
          }
        }

      } else if (tipe == "2x") {                        //fRute(" tipe:".concat(tipe));
        if (frekuensi == "sekali") { 
          if (frekModeKe == 2){ 
            audioPlayer.currentTime = 0;
            pengaturanVolume();
            audioPlayer.play();
          } else if (frekModeKe == 1){            
            pengaturanVolume();
            putarAudio();
          }
        } else if(frekuensi == "berulangkali"){         //fRute(" frekuensi:".concat(frekuensi));             
          if (frekModeKe == 2){                         //fRute(" frekModeKe:".concat(frekModeKe)); 
            audioPlayer.currentTime = 0;                 
            pengaturanVolume();                         
            audioPlayer.play();                          
          } else if (frekModeKe == 1){                  //fRute(" frekModeKe:".concat(frekModeKe));           
            if (dahPutar < putaran.value){              //fRute(" dahPutar<".concat(putaran.value)); 
              if (dahPutar == 1){                       //fRute(" dahPutar=1"); 
                pengaturanVolume();                       
                putarAudio();
              } else {                                  //fRute(" dahPutar<>1"); 
                audioPlayer.currentTime = 0;               
                pengaturanVolume();                        
                audioPlayer.play();                       
              }                
            } else {                                    //fRute(" dahPutar>=".concat(putaran.value));            
              pengaturanVolume();                       
              putarAudio();                              
            }
          }
        }
      }
    });

    function pengaturanVolume(){                        fRute(" pengVol()");
      if (tipe == "1x"){                                fRute(" tipe:".concat(tipe)); 
        switch (mode.value){                                       // konversi: mode ke audio_volume: di awal
          case "ds": audioPlayer.muted = false; break;
          case "d1": audioPlayer.muted = ((nomor+1) % 2 !== 0) ? false : true; break;
          case "d2": audioPlayer.muted = ((nomor+1) % 2 === 0) ? false : true; break;
        }
      } else if (tipe == "2x"){                         fRute(" tipe:".concat(tipe)); 
          if (frekModeKe == 1){                         fRute(" frekModeKe:".concat(frekModeKe)); 
            switch (mode.value){                          
              case "db": audioPlayer.muted = false; break;
              case "bd": audioPlayer.muted = true; break;              
            }
          } else if (frekModeKe == 2){                  fRute(" frekModeKe:".concat(frekModeKe)); 
            switch (mode.value){                          
              case "db": audioPlayer.muted = true; break;
              case "bd": audioPlayer.muted = false; break;              
            }
          }
      }
    }    

    function putarAudio(){                              //fRute(" PutarAudio()");                                                
      
      audioPlayer.src = URL.createObjectURL(varrayFile[nomor]);   //membuat URL untuk source audio                                                             
      audioPlayer.play();                                         //memutar file audio      
    }

    function juruHitung(){                              //fRute(" juruHitung()"); 

      if (frekModeKe < angkaFrekMode){                  //fRute(" frekModeKe<".concat(angkaFrekMode)); 
        frekModeKe ++;                                  
      } else {                                          //fRute(" frekModeKe>=".concat(angkaFrekMode)); 
          frekModeKe = 1;                               
        if (dahPutar < putaran.value){                  //fRute(" dahPutar<".concat(putaran.value)); 
          dahPutar ++;                                  
        } else {                                        //fRute(" dahPutar>=".concat(putaran.value)); 
          dahPutar = 1;                                 
          if ((nomor+1)<sampai_BarisKe){             //fRute(" (nomor+1)<".concat(varrayFile.length)); 
            nomor ++;                                   
          } else {                                      //fRute(" (nomor+1)>=".concat(varrayFile.length)); 
            nomor = mulai_BarisKe;                                  //fRute(" (nomor)=".concat(nomor)); 
            if (modeGanjilGenap.checked == true){       //fRute(" modeGanjilGenap.value ==".concat(modeGanjilGenap.value)); 
              if (mode.value == "d1"){                  //fRute(" mode.value ==".concat(mode.value)); 
                mode.value = "d2";                      //fRute(" mode.value =".concat(mode.value)); 
              } else if (mode.value == "d2"){           //fRute(" mode.value ==".concat(mode.value)); 
                mode.value = "d1";                      //fRute(" mode.value =".concat(mode.value)); 
              }
            }                              
          }
        }
      }
    }

    // Tombol STOP
    stopButton.addEventListener('click', function () {
      audioPlayer.pause();
      audioPlayer.currentTime = 0;
      indikatorAudio.textContent = "dihentikan ..";
    });

    prevButton.addEventListener('click', function () {            
      audioPlayer.pause(); 
      audioPlayer.currentTime = 0; 
      nomor = (nomor > 0) ? nomor - 1 : varrayFile.length - 1;      //nomor = nomor-1, jika nomor > 0, jika tidak, maka nomor = jumlah audio
      audioPlayer.src = URL.createObjectURL(varrayFile[nomor]);     //membuat URL untuk source audio
      audioPlayer.play(); 
    });

    nextButton.addEventListener('click', function () {            
      audioPlayer.pause(); 
      audioPlayer.currentTime = 0; 
      nomor = (nomor < varrayFile.length - 1) ? nomor + 1 : 0;      //nomor = nomor+1, jika nomor < jumlah audio, jika tidak, maka nomor=0
      audioPlayer.src = URL.createObjectURL(varrayFile[nomor]);     //membuat URL untuk source audio
      audioPlayer.play(); 
    });
    
    mode.addEventListener('change', function () {                   //jika tombol mode di klik maka jalankan:      
      updatePilihanPutaran();
      switch (mode.value){                                          //konversi: mode ke tipe
        case "bd": tipe = "2x"; angkaFrekMode = 2; break;
        case "db": tipe = "2x"; angkaFrekMode = 2; break;
        case "ds": tipe = "1x"; angkaFrekMode = 1; break;
        case "d1": tipe = "1x"; angkaFrekMode = 1; break;
        case "d2": tipe = "1x"; angkaFrekMode = 1; break;
      }
      frekMode.textContent = `m ${frekModeKe}/${angkaFrekMode}`;
      tampilkanDivGanjilGenap()
      pengaturanVolume();
    });
                                                                    //jika putaran di klik maka jalankan:
    putaran.addEventListener('change', function () {   fRute(" 1-")   
      putaran2frekuensi();                             fRute(" 2-")
      putaranKe.textContent = `p 0/${putaran.value}`;  fRute(" 3-")
    })

    putaran.addEventListener('click', function () {    fRute(" 4-")
      updatePilihanPutaran();                          fRute(" 5-")     
    })

    function putaran2frekuensi(){                       fRute(" 6-")                                  //fungsi konversi angka putaran ke 'berulangkali / sekali'
      if (Number(putaran.value)>1){                     fRute(" 7-")
        frekuensi = "berulangkali";                     fRute(" 8-")               
      }else{                                            fRute(" 9-")               
        frekuensi = "sekali";                           fRute(" 10-")                 
      }      
    }

    tombolFitur.addEventListener('click', function () {
      if (sembunyikan =="ya"){        
        isiFitur.style.display = 'block';
        isiCatatan.style.display = 'none';
        sembunyikan = "tidak";
      } else {
        isiFitur.style.display = 'none';
        sembunyikan = "ya";
      }
    });
                                                                    //fungsi untuk menggantikan peran alert (1), yaitu untuk
    function fRute(a){                                              //... menandai baris coding yg dibaca oleh web browser
      if (aktifkanRute == true){
        ruteku = a; 
        semuaRuteku = semuaRuteku.concat(ruteku); 
        rute.textContent = semuaRuteku;
      }
    }

    tombolRuteku.addEventListener('click', function () {
      if (aktifkanRute == true){ 
        aktifkanRute = false;      
        semuaRuteku = "";
        rute.textContent = semuaRuteku;
        tombolRuteku.style.backgroundColor ="lightgrey";
      } else {
        aktifkanRute = true;
        tombolRuteku.style.backgroundColor = "grey";
      }
    });
    
    simpanCounterBaru.addEventListener('click', function () {
      audioKe.style.display = "inline-block";
      putaranKe.style.display = "inline-block";
      frekMode.style.display = "inline-block";     
      petunjukUbah.style.display = "none";      
      a_Baru.style.display = "none";
      p_Baru.style.display = "none";
      m_Baru.style.display = "none";      
      a_max.style.display = "none";
      p_max.style.display = "none";fRute(" 1"); 
      m_max.style.display = "none";fRute(" 2");       
      simpanCounterBaru.style.display = "none";fRute(" 3"); 
      nomor = Number(a_Baru.value)-1;fRute(" 4"); 
      dahPutar = Number(p_Baru.value);fRute(" 5"); 
      frekModeKe = Number(m_Baru.value);fRute(" 6"); 
      
      juruTulis();fRute(" 8");
      audioPlayer.src = URL.createObjectURL(varrayFile[nomor]);
      pengaturanVolume();
    });

    function updatePilihanPutaran(){
      let putaranvalue;
      putaranValue = putaran.value;
      putaran.textContent = "";
      if (mode.value === "db" || mode.value === "bd" || mode.value === "ds") {                                                                            
          for (let i = 1; i <= 10; i++) {                                                                     
              const option = document.createElement("option");      //Tambahkan opsi 1-10
              option.value = i;
              option.textContent = i;
              putaran.appendChild(option);
              putaran.value = putaranValue;
          }
      } else if (mode.value === "d1" || mode.value === "d2") {                                                                           
          const option = document.createElement("option");          //Tambahkan opsi hanya 1
          option.value = 1;
          option.textContent = 1;
          putaran.appendChild(option);
      }
    }  

    audioKe.addEventListener('click', function () {
      ubahCounters()  
    });
    putaranKe.addEventListener('click', function () {
      ubahCounters()  
    });
    frekMode.addEventListener('click', function () {
      ubahCounters()  
    });

    function ubahCounters(){
      audioKe.style.display = "none";
      putaranKe.style.display = "none";
      frekMode.style.display = "none";     
      petunjukUbah.style.display = "inline-block";      
      a_Baru.style.display = "inline-block";
      p_Baru.style.display = "inline-block";
      m_Baru.style.display = "inline-block";
      a_Baru.value = nomor + 1;
      p_Baru.value = dahPutar;
      m_Baru.value = frekModeKe;
      a_max.style.display = "inline-block";
      p_max.style.display = "inline-block";
      m_max.style.display = "inline-block";
      a_max.textContent =`/${varrayFile.length}`;
      p_max.textContent =`/${putaran.value}`;
      m_max.textContent =`/${angkaFrekMode}`;
      simpanCounterBaru.style.display = "inline-block";  
    }

    function tampilkanDivGanjilGenap(){
      if (mode.value === "d1" || mode.value === "d2") {
        divGanjilGenap.style.display = 'flex';
      }
    }

    tombolCatatan.addEventListener('click', function () {
      if (sembunyikan =="ya"){        
        isiCatatan.style.display = 'block';
        isiCaranya.style.display = 'none';     
        isiFitur.style.display = 'none';
        sembunyikan = "tidak";
      } else {
        isiCatatan.style.display = 'none';
        sembunyikan = "ya";
      }
    });   
    
    tombolCaranya.addEventListener('click', function () {
      if (sembunyikan =="ya"){   
        isiCaranya.style.display = 'block';     
        isiCatatan.style.display = 'none';
        isiFitur.style.display = 'none';
        sembunyikan = "tidak";
      } else {
        isiCaranya.style.display = 'none';
        sembunyikan = "ya";
      }
    });  

  </script>
</body>
</html>
